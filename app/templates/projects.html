{% extends "base.html" %}

{% block title %}プロジェクト管理 - 化合物データ管理システム{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>プロジェクト管理</h1>
    <a href="{{ url_for('main.add_project') }}" class="btn btn-primary">新しいプロジェクトを追加</a>
</div>

{% if projects %}
<div class="row">
    {% for project in projects %}
    <div class="col-md-6 col-lg-4 mb-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">{{ project.name }}</h5>
                {% if project.description %}
                <p class="card-text">{{ project.description }}</p>
                {% endif %}
                <p class="text-muted mb-2">化合物: {{ project.compounds|length }}件</p>
                <p class="text-muted mb-3">作成日: {{ project.created_date.strftime('%Y-%m-%d') }}</p>
                <div class="d-flex gap-2">
                    <a href="{{ url_for('main.index', project_id=project.id) }}" class="btn btn-outline-primary btn-sm">化合物表示</a>
                    <a href="{{ url_for('main.edit_project', project_id=project.id) }}" class="btn btn-outline-secondary btn-sm">編集</a>
                    <button type="button" class="btn btn-outline-danger btn-sm" onclick="deleteProject({{ project.id }}, '{{ project.name }}')">削除</button>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="text-center mt-5">
    <h4 class="text-muted">プロジェクトが登録されていません</h4>
    <a href="{{ url_for('main.add_project') }}" class="btn btn-primary mt-3">最初のプロジェクトを追加</a>
</div>
{% endif %}

<script>
function deleteProject(projectId, projectName) {
    if (confirm(`プロジェクト「${projectName}」を削除しますか？\n\n※関連する化合物は未分類になります。`)) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '/delete_project/' + projectId;
        document.body.appendChild(form);
        form.submit();
    }
}
</script>
{% endblock %}